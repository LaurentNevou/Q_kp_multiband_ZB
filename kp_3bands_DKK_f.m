function[E]=kp_3bands_DKK_f(k_list, g1, g2, g3)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Constants %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

h=6.62606896E-34;               %% Planck constant [J.s]
hbar=h/(2*pi);
e=1.602176487E-19;              %% charge de l electron [Coulomb]
m0=9.10938188E-31;              %% electron mass [kg]
H0=hbar^2/(2*m0) ;

L =  H0*(-1-g1-4*g2);
M =  H0*(-1-g1+2*g2);
N = -H0*6*g3;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%% Building of the Hamiltonien %%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

for i=1:length(k_list(:,1))
  
kx = k_list(i,1);
ky = k_list(i,2);
kz = k_list(i,3);

k=sqrt(kx.^2 + ky.^2 + kz.^2);

Hdiag = H0*k^2 * [1 1 1];

H_DKK=[

L*kx^2+M*(ky^2+kz^2)           N*kx*ky                 N*kx*kz
      N*kx*ky           L*ky^2+M*(kx^2+kz^2)           N*ky*kz
      N*kx*kz                  N*ky*kz           L*kz^2+M*(kx^2+ky^2)
];

H = diag(Hdiag) + H_DKK ;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

E(:,i) = eig(H)/e;

% Solution when k=[1 0 0]=[0 1 0]=[0 0 1]
%l1=(1+L )  /e*H0*k^2
%l2=(1+M )  /e*H0*k^2

% Solution when k=[1 1 0]=[1 0 1]=[0 1 1]
%l1=(1+(L+M+N)/2 )  /e*H0*k^2
%l2=(1+(L+M-N)/2 )  /e*H0*k^2
%l3=(1+M)           /e*H0*k^2

% Solution when k=[1 1 1]
%l1=(1+(L+2*M+2*N)/3 )  /e*H0*k^2
%l2=(1+(L+2*M-N)/3 )    /e*H0*k^2

end

end